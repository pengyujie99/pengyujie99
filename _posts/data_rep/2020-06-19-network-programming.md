---
title: "Network Programming"
date:  2020-06-19 12:00:00
subtitle: "了解网络编程"
layout: post
author: "Pengyujie"
header-style: text
tags:
  - 笔记
  - 基础
  - 网络编程
---

>HTTP与HTTPS的关系？访问一个网站的过程？DNS？...



## 初识网络编程

在学习Java网络编程之前，我们先来了解什么是计算机网络。

计算机网络是指两台或更多的计算机组成的网络，在同一个网络中，任意两台计算机都可以直接通信，因为所有计算机都需要遵循同一种网络协议。

那什么是互联网呢？

互联网是网络的网络（internet），即把很多计算机网络连接起来，形成一个全球统一的互联网。

**定位到一个服务**

- 定位到一个主机（计算机）：IP地址  

- 定位到一个程序应用的进程：port  

通过一个IP地址和port（**IP:Port**）就可以定位到世界上的任意一台电脑正在运行的服务。每一台电脑的port端口号 不可冲突 0-65535个端口号  。

IP地址 分类 IPV4/IPV6  IPV4很早便被分配完了。  

IPV4：127.0.0.1    0-255  

IPV6：fe80::e52d:e74f:c6b6:43cf%15  128位  

```
ABC类地址
1.0.0.1 -A类- 128.0.0.1 -B类-  192.0.0.1  -C类-
```


- 局域网

如果两台计算机位于同一个网络，那么他们之间可以直接通信，因为他们的**IP地址前段是相同的**，也就是网络号是相同的。网络号是IP地址通过子网掩码过滤后得到的。

255.255.0.1/16 #16表示的是前面二位相同就是在同一网络 如果是24 表示的是前面三位相同就是在同一网络

可以写成00000000 .00000000 .00000000 .00000000

此时只要前二位相同255.255.0.1 - 255.255.255.254  有65533（256*256-2）个可以分配的地址

如果是255.255.0.1/24

要前三位相同255.255.0.1 - 255.255.0.254  有254（256-2）个可以分配的地址



- 通信协议

TCP/IP协议泛指互联网协议，其中最重要的两个协议是TCP协议和IP协议。只有使用TCP/IP协议的计算机才能够联入互联网，使用其他网络协议（例如NetBIOS、AppleTalk协议等）是无法联入互联网的。

TCP/IP协议簇  TCP/IP协议又叫网络通讯协议 它包括了TCP、IP、UDP、FTP、SMTP等许多协议。  

TCP协议对应传输层，IP协议对应网络层，HTTP协议对应应用层 http是无状态的通信协议。

RPC协议是指远程过程调用，指一种进程间的通信方式，它允许程序调用另一个地址空间（另一个主机）的过程或函数。RPC指的是跨网络实现的远程调用。可以跨语言实现。



我们常说的socket编程又是什么意思？  

socket并不是一个协议，它只是封装了TCP/IP协议，它是一组调用TCP/IP协议的API函数。  

是进行socket网络编程调用的一组接口。



## 访问一个网站
```
用户访问一个网站，输入其域名进访问，首先在自身缓存中查看有没有解析过这个域名，有则返回，
没有则通过DNS解析，计算机的DNS（这个DNS可以自己设置，在C盘的hosts的文件），相当于一个邮
局，你将你所需要的连接的网站的域名给它，由他进行解析返回给你IP地址。这时候你就可以访问了
```
注意：如果你的DNS不靠谱可能会返回给你，错的IP地址，比如你访问淘宝，可能最后返回了你京东的IP地址。


## HTTP和HTTPS
HTTP缺点：

- 请求信息明文传输，容易被窃听截取。
- 数据的完整性未校验，容易被篡改
- 没有验证对方身份，存在冒充危险



HTTPS缺点：

- HTTPS协议多次握手，导致页面的加载时间延长近50%；
- HTTPS连接缓存不如HTTP高效，会增加数据开销和功耗；
- 申请SSL证书需要钱，功能越强大的证书费用越高。
- SSL涉及到的安全算法会消耗 CPU 资源，对服务器资源消耗较大。

```shell
事实上个人理解就是，HTTPS是在HTTP协议的基础上加了SSL协议，变得更为安全，同时SSL认证通常是需要购买的，
尤其是一些大型网站，淘宝之类的，购买的金额更是恐怖，使用了SSL协议之后速度也要慢一点。
HTTP是通过明文传输数据，很容易被不法分子进行抓包，然后修改其中数据。HTTPS相当于HTTP协议的安全版本。
```


```
HTTPS
1.首先客户端通过URL访问服务器建立SSL连接。
2.服务端收到客户端请求后，会将网站支持的证书信息（证书中包含公钥）传送一份给客户端。
3.客户端从证书中提取公钥并生成一个主秘钥MS。然后客户端使用公钥对其进行加密，发送给服务器。
4.服务器利用自己的私钥解密出主秘钥MS。
5.服务器利用主秘钥MS加密与客户端之间的通信。
```
区别：  

HTTPS是HTTP协议的安全版本，HTTP协议的数据传输是明文的，是不安全的，HTTPS使用了SSL/TLS协议进行了加密处理。  

http和https使用连接方式不同，默认端口也不一样，http是80，https是443。



##  TCP的连接

- 三次握手

![image-20210609162958414](C:\Blog\pengyujie99.github.io\img\notes\net\1.png)

- 四次挥手

![image-20210609163008779](C:\Blog\pengyujie99.github.io\img\notes\net\2.png)

## IO和NIO

  NIO即New IO，这个库是在JDK1.4中才引入的。NIO和IO有相同的作用和目的，但实现方式不同，NIO主要用到的是块，所以NIO的效率要比IO高很多。在Java API中提供了两套NIO，一套是针对标准输入输出NIO，另一套就是网络编程NIO。

| **IO** | **NIO**  |
| ------ | -------- |
| 面向流 | 面向缓冲 |
| 阻塞IO | 非阻塞IO |
| 无     | 选择器   |

 传统的socket IO中，需要为每个连接创建一个线程，当并发的连接数量非常巨大时，线程所占用的栈内存和CPU线程切换的开销将非常巨大。使用NIO，不再需要为每个线程创建单独的线程，可以用一个含有限数量线程的线程池，甚至一个线程来为任意数量的连接服务。由于线程数量小于连接数量，所以每个线程进行IO操作时就不能阻塞，如果阻塞的话，有些连接就得不到处理，NIO提供了这种非阻塞的能力。

   这种服务方式跟传统的区别有两个：

1、增加了一个角色，要有一个专门负责收集客人需求的人。NIO里对应的就是Selector。

2、由阻塞服务方式改为非阻塞服务了，客人吃着的时候服务员不用一直侯在客人旁边了。传统的IO操作，比如read()，当没有数据可读的时候，线程一直阻塞被占用，直到数据到来。NIO中没有数据可读时，read()会立即返回0，线程不会阻塞。

   NIO中，客户端创建一个连接后，先要将连接注册到Selector，相当于客人进入餐厅后，告诉前台你要用餐，前台会告诉你你的桌号是几号，然后你就可能到那张桌子坐下了，SelectionKey就是桌号。当某一桌需要服务时，前台就记录哪一桌需要什么服务，比如1号桌要点菜，2号桌要结帐，服务员从前台取一条记录，根据记录提供服务，完了再来取下一条。这样服务的时间就被最有效的利用起来了。




References
----------

- <https://en.wikipedia.org/wiki/Integer_(computer_science)>
- <https://zhuanlan.zhihu.com/p/72616216>













